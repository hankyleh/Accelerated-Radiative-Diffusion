\documentclass{template}
\title{Synthetic Acceleration for Radiative Diffusion Calculations\\
  \large Notes on Morel, Larsen, Matzen 1985~\cite{morel1985synthetic}}

\author{Kyle Hansen}
\date{10 October 2025}



\newcommand*\Let[2]{\State{#1 $\gets$ #2}}
\algrenewcommand\algorithmicrequire{\textbf{Precondition:}}
\algrenewcommand\algorithmicensure{\textbf{Postcondition:}}


\newcommand*\multbox[1]{\fbox{\hspace{0ex}#1\hspace{0ex}}}



\begin{document}

\maketitle

\section{Radiative Diffusion Equations}

The radiative diffusion equations are:

\begin{gather}
\label{eq:spectral_temperature}
\rho C_v \frac{\partial T}{\partial t} = \nabla \cdot K \nabla T - \nabla {\mathbb{P}u} + \rho \int_0^\infty \kappa(E^\prime)\left[ I(E^\prime) - \beta(E^\prime, T) \right] dE^\prime + Q\\
\label{eq:spectral_diffusion}
\frac{1}{c}\frac{\partial I}{\partial t} - \nabla \cdot D(E) \nabla I(E) + \rho \kappa(E)I(E) = \rho\kappa(E)\beta(E, T), 
\end{gather}

where $t$ is time, $\vec{r}$ is position, $E = h\nu$ is photon energy, $C_v$ is material specific heat, $K$ is thermal conductivity, $\mathbb{P}$ is the pressure tensor (from both material and radiation pressure), $u$ is material velocity, $\kappa$ is specific absorption opacity in units of $[\text{area}/\text{mass}]$, $\rho$ is material density, $D$ is the photon diffusion coefficient, $T$ is material temperature, $I(\vec{r}, E) = \int d\Omega \; I(x, \Omega, E)$ is photon intensity in units of $[\text{energy}/\text{area}\cdot\text{time}]$, and $Q$ is material energy source.

Integrating \autoref{eq:spectral_temperature} and \autoref{eq:spectral_diffusion} over $N_g$ energy groups yields the multigroup radiative diffusion equations:

\begin{gather}
  \label{eq:multigroup_temperature}
  \rho C_v \frac{\partial T}{\partial t} = \nabla \cdot K \nabla T - \nabla {\mathbb{P}u} + \rho \sum_{g=1}^{N_g} \kappa_g \left[ I_g - \beta_g(T) \right] + Q\\
  \label{eq:multigroup_diffusion}
  \frac{1}{c}\frac{\partial I_k}{\partial t} - \nabla \cdot D_k \nabla I_k + \rho \kappa_k I_k = \rho\kappa_k \beta_k(T); \qquad k=1\dots N_g
\end{gather}

where

\begin{subequations}
  \begin{align}
    \int_k \cdot \; dE &= \int_{E_k}^{E_{k+1}}\cdot\; dE\\
    I_k &= \int_k I(E) dE\\
    \beta_k(T) &= \int_k \beta(E, T) dE\\
    D_k \nabla I_k &= \int_k D(E) \nabla I(E) dE\\
    \kappa_k &= \frac{\int_g \kappa(E) \left[ \beta(E) - I(E) \right] dE}{\int_g \left[ \beta(E) - I(E) \right] dE}
  \end{align}
\end{subequations}


where the multigroup equations are only exact if the $E$-spectrum is known exactly within each energy group, though the approximation is close to exact when the number of energy groups is high. Rosseland- or Planck-weighted group constants are used to approximate the spectrum. Pressure $\mathbb{P}$, material velocity $\vec{u}$, thermal conductivity $K$, and density $\rho$ are taken to be known exactly, since they come from hydrodynamic equations.

Discretizing in time with Backward Euler and using lagged opacity, thermal conductivity, diffusion coefficient, and heat capacity:

\begin{gather}
  \rho C_v^n \frac{T^{n+1} - T^n}{\Delta t^n} = \nabla \cdot K^n \nabla T^{n+1} - \nabla {\mathbb{P}u} + \rho \sum_{g=1}^{N_g} \kappa_g^n \left[ I_g^{n+1} - \beta_g^{n+1}(T) \right] + Q^{n+1}\\
  \frac{1}{c}\frac{I^{n+1} - I^n}{\Delta t^n} - \nabla \cdot D_k^n \nabla I_k^{n+1} + \rho \kappa_k^n I_k^{n+1} = \rho \kappa_k^n \beta_k(T(t)); \qquad k=1\dots N_g
\end{gather}

Then, the time advancement of $\beta$ can be approximated using a first-order Taylor expansion, $\beta_k^{n+1} \approx \beta_k^n + \frac{\partial \beta_k^n}{\partial T}\Delta T^{n+1}$, and the temperature operator is split into two parts-- radiative/inhomogenous source and thermal conductivity/pressure. The linearized, time-discretized equations are:


  \begin{gather}
    \label{eq:MEB}\rho C_v^n \frac{\Delta T^{n+1/2}}{\Delta t^n} =  \rho \sum_{g=1}^{N_g} \kappa_g^n \left[ I_g^{n+1} - \left( \beta_k^n + \frac{\partial \beta_k^n}{\partial T}\Delta T^{n+1}\right) \right] + Q^{n+1}\\
    \label{eq:intermediate_intensity}\frac{1}{c}\frac{I^{n+1} - I^n}{\Delta t^n} - \nabla \cdot D_k^n \nabla I_k^{n+1} + \rho \kappa_k^n I_k^{n+1} = \rho \kappa_k^n \left( \beta_k^n + \frac{\partial \beta_k^n}{\partial T}\Delta T^{n+1}\right); \qquad k=1\dots N_g\\
    \rho C_v^n \frac{\Delta T^{n+1}}{\Delta t^n} = \nabla \cdot K^n \nabla T^{n+1} - \nabla \cdot {\mathbb{P}u}
  \end{gather}




Where $\Delta T^{n+1/2}$ is an intermediate value for the temperature at $t^{n+1}$, not at an intermediate time step, and $T^{n+1/2} = T^n + \Delta T^{n+1/2}$ and $T^{n+1} = T^{n+1/2} + \Delta T^{n+1}$. $\Delta T^{n+1/2}$ can be easily evaluated algebraically from \autoref{eq:MEB}:

\begin{equation}
  \label{eq:intermediate_temperature}\Delta T^{n+1/2} = \left[    \sum_{g=1}^{N_g} \kappa_g^n \left( I_g^{n+1} -  \beta_k^n  \right) +  \frac{Q^{n+1}}{\rho}    \right] \cdot {\left[  \frac{ C_v^n}{\Delta t^n}  + \sum_{g=1}^{N_g}\kappa_g^n \frac{\partial \beta_g^n}{\partial T}\right]}^{-1}
\end{equation}

Evaluating \autoref{eq:intermediate_intensity} using \autoref{eq:intermediate_temperature} yields

% TODO
\begin{equation}
  \frac{1}{c \Delta t^n}\left( I^{n+1} - I^n \right)- \nabla \cdot D_k^n \nabla I_k^{n+1} + \rho \kappa_k^n I_k^{n+1} = \dots TODO
\end{equation}

which reduces to the final form of the multigroup diffusion equation,

\begin{equation}\label{eq:standard_diffusion}
  \frac{1}{c \Delta t^n}\left( I^{n+1} - I^n \right)- \nabla \cdot D_k^n \nabla I_k^{n+1} + \rho \kappa_k^n I_k^{n+1} = \eta \chi_k \rho \sum_{g=1}^{N_g}\kappa_g I_g^{n+1} + q_k
\end{equation}

where
\begin{subequations}
  \begin{align}
    \eta   &=  \left[\sum_{g=1}^{N_g}\kappa_g\frac{\partial \beta_g}{\partial T}\right] \cdot {\left[ \frac{C_v}{\Delta t^n} + \sum_{g=1}^{N_g}\kappa_g\frac{\partial \beta_g}{\partial T} \right]}^{-1} \\
    \chi_k &=  \left[ \kappa_k  \frac{\partial \beta_k}{\partial T}   \right] \cdot {\left[\sum_{g=1}^{N_g}\kappa_g\frac{\partial \beta_g}{\partial T}\right]}^{-1} \\
    q_k    &=  \rho \kappa_k \beta_k  +  \eta \chi_k \left[ Q - \rho \sum_{g=1}^{N_g}\kappa_g\frac{\partial \beta_g}{\partial T} \right]
  \end{align}
\end{subequations}


\autoref{eq:standard_diffusion} resembles the steady-state neutron diffusion equation, which can be made clear by further rearranging the terms:

\begin{equation}\label{eq:neutron_diffusion}
  -\nabla \cdot D_k \nabla I_k^{n+1} + \left( \sigma_a + \sigma_{f, k} \right)I_k^{n+1} = \eta \chi_k \sum_{g=1}^{N_g}\sigma_{f, g}I_g^{n+1} + S_k
\end{equation}

where

\begin{subequations}\label{eq:neutron_xs}
  \begin{align}
  \sigma_a     &= \frac{1}{c\Delta t^n}\\
  \sigma_{f, k} &= \rho \kappa_k\\
  S_k &= q_k + \frac{I_k^n}{c\Delta t^n}
\end{align}
\end{subequations}

with ``fission'' and ``absorption'' cross sections, and fission emission spectrum $\chi_k$. The fission term will be known as the reimission term.

\subsection{Iterative solution}\label{sec:iterative_solution}


\autoref{eq:neutron_diffusion} can be solved by source iteration, starting from some initial guess $I_{k}^{(0)}$ and using to compute the next iterate $I^{(1)}$, or using each iterate $I_{k}^{l}$ to compute $I_{k}^{l+1}$. Surpressing the $n+1$ index, the iterative equation is

\begin{equation}\label{eq:iterative_neutron}
  -\nabla \cdot D_k \nabla I_k^{l+1} + \left( \sigma_a + \sigma_{f, k} \right)I_k^{l+1} = \eta \chi_k \sum_{g=1}^{N_g}\sigma_{f, g}I_g^l + S_k
\end{equation}

\section{Acceleration Scheme}

The iterative method described in \autoref{sec:iterative_solution} can be written in operator notation as the solution to the linear system

\begin{equation}
  \mathcal{M}x = y,
\end{equation}

where the exact solution is denoted as $x^\star$. The solution is solved iteratively by splitting the operator $\mathcal{M} = \mathcal{A} - \mathcal{B}$, and $\mathcal{A}$ is easily inverted. The iterative method is then

\begin{align}
  \mathcal{A}x^{l+1} &= \mathcal{B}x^l + y\\
  x^{l+1} &=  \mathcal{A}^{-1} \mathcal{B}x^l + \mathcal{A}^{-1}y.
\end{align}

For the radiative diffusion equation (\autoref{eq:neutron_diffusion}), $\mathcal{A}$ is the streaming and absorption operator, and $\mathcal{B}$ is the reemission (``fission'') source. The error of the $(l+1)$th iterate is

\begin{equation}
  \epsilon^{l+1} = x^\star - x^{l+1}
\end{equation}

Then the exact solution can be found from the $(l+1)$th iterate using

\begin{subequations}
  \begin{align}
  \mathcal{B}x^l + y &= \mathcal{A}x^{l+1}\\
  y & = \mathcal{A}x^{l+1} - \mathcal{B}x^l\\
  \mathcal{M}x^\star &= \mathcal{A}x^{l+1} - \mathcal{B}x^l\\
  x^\star &= \mathcal{M}^{-1} \left(\mathcal{A}x^{l+1} - \mathcal{B}x^l \right)\\
          &= \mathcal{M}^{-1} \left(\mathcal{A}x^{l+1} - \mathcal{B}x^{l+1}+\mathcal{B}x^{l+1}- \mathcal{B}x^l \right)\\
          &= \mathcal{M}^{-1} \left(\mathcal{M}x^{l+1} +\mathcal{B}{\left( x^{l+1}- x^l \right) }\right)\\
          \label{eq:exact_iterative}x^\star &=  x^{l+1} + \mathcal{M}^{-1}\mathcal{B}{\left( x^{l+1}- x^l \right)} = x^{l+1} + \epsilon^{l+1}
  \end{align}
\end{subequations}

The iteration can be accelerated by evaluating \autoref{eq:exact_iterative} using an approximation $\mathcal{W} \approx \mathcal{M}$, which can be more easily inverted. Here $\mathcal{M}$ is called the high-order operator, and $\mathcal{W}$ is the low-order operator.

The accelerated iteration scheme is

\begin{align}
  x^{l+1/2} &=  \mathcal{A}^{-1} \mathcal{B}x^l + \mathcal{A}^{-1}y\\
  x^{l+1}   &=  x^{l+1/2} + \mathcal{W}^{-1}\mathcal{B}{\left( x^{l+1/2}- x^l \right)}
\end{align}

when solving the radiative diffusion equation, the high-order operator $\mathcal{M}$ is the system of multigroup diffusion equations. The acceleerated scheme presented in~\cite{morel1985synthetic} uses a one-group diffusion operator as the low-order operator $\mathcal{W}$.

Fourier analyis of the high-order equation shows that the slowest-converging mode is ${\omega(\lambda=0)}$, or

\begin{equation}
  \omega_{\max} = \omega(0) = \eta \sum_{g=1}^{N_g} \frac{\chi_g \sigma_{f,g}}{\sigma_a + \sigma_{f,g}}
\end{equation}

Where $\omega_{\max}$ approaches $1$ as the $\Delta t^n$ is increased. For small time steps, $\omega_{\max} \approx \eta$, which approaches unity for strongly coupled problems, where $C_v$ is small or $\kappa$ is large.

The most effective acceleration schemes should approximate the high-order equations accurately about $\lambda = 0$. This solution corresponds with an equilibrium solution, which will be the focus of the low-order equation.~\autoref{sec:fourier_analysis} details the derivation of this result.

The multigroup equation for the error of the $l$th iterate of \autoref{eq:iterative_neutron} is

\begin{equation}
  \label{eq:error-diffusion-equation}-\nabla \cdot D_k\nabla \epsilon_k^{l} + \left(\sigma_a + \sigma_{f, k}\right)\epsilon_k^{l} = \eta \chi_k \sum_{g=1}^{N_g} \sigma_{f, g} \left[ \epsilon_g^{l} +I_g^{l} - I_g^{l-1} \right]; \; k=1, 2,\dots, N_g
\end{equation}

In the equilibrium limit, where the gradient term becomes zero, this equation becomes

\begin{align}
  \left(\sigma_a + \sigma_{f, k} \right)\epsilon_k^l &= \eta\chi_k \sum_{g=1}^{N_G}\sigma_{f, g}\epsilon_g^l + \eta\chi_k \sum_{g=1}^{N_G}\sigma_{f, g}\left(I_g^l - I_g^{l-1} \right)\\
  \sigma_{t, k}\epsilon_k^l &= \eta\chi_k \left( \xi^l + r^l \right)\\
  \epsilon_k^l &= \frac{\eta\chi_k}{\sigma_{t, k}} \left( \xi^l + r^l \right)\label{eq:first-step-eq-spectrum}
\end{align}

where
\begin{align}
  \sigma_{t, k} &= \sigma_a + \sigma_{f, k}\\
  r^l &= \sum_{g=1}^{N_G}\sigma_{f, g}\left(I_g^l - I_g^{l-1} \right)\\
  \xi^l &= \sum_{g=1}^{N_G}\sigma_{f, g}\epsilon_g^l
\end{align}

then, to solve for $\xi^i$, \autoref{eq:first-step-eq-spectrum} is multiplied by $\sigma_{f, k}$ and summed over all $k$:

\begin{align}
  \sum_{k=1}^{N_g} \sigma_{f, k}\epsilon_k^l &= \sum_{k=1}^{N_g} \sigma_{f, k}\frac{\eta\chi_k}{\sigma_{t, k}} \left( \xi^l + r^l \right)\\
  \xi^l &= \eta \left( \xi^l + r^l \right) \sum_{k=1}^{N_g}\frac{ \chi_k \sigma_{f,k}}{\sigma_{t, k}}\\
  \xi^l &= \eta \left( \xi^l + r^l \right) \frac{\langle \sigma_f \rangle}{\langle \sigma_t \rangle}\label{eq:second-step-eq-spectrum}
\end{align}

where

\begin{align}
  \langle \sigma_f \rangle &= \langle \sigma_t \rangle \sum_{g=1}^{N_g} \frac{\chi_g \sigma_{f, g}}{\sigma{t, g}}\\
  \langle \sigma_t \rangle &= {\left[\sum_{g=1}^{N_g} \frac{\chi_g}{\sigma_{t, g}} \right]}^{-1}
\end{align}

then \autoref{eq:second-step-eq-spectrum} can be solved for $\xi^l$,

\begin{subequations}
  \begin{align}
  \xi^l &= \eta \left( \xi^l + r^l \right) \frac{\langle \sigma_f \rangle}{\langle \sigma_t \rangle}\\
  \frac{\xi^l\langle \sigma_t \rangle}{\eta \langle \sigma_f \rangle} &= \left( \xi^l + r^l \right)\\
  \xi^l &= \frac{r^l}{\frac{\langle \sigma_t \rangle}{\eta \langle \sigma_f \rangle} - 1}\\
  \xi^l &= \frac{\eta \langle \sigma_f \rangle r^l}{\langle \sigma_t \rangle - \eta \langle \sigma_f \rangle}
\end{align}
\end{subequations}


yielding the final equilibrium solution of the $l$th iterate error, 

\begin{subequations}
  \begin{align}
    \epsilon_k^l &= \frac{\eta\chi_k}{\sigma_{t, k}} \left( \xi^l + r^l \right)\\
    \sigma_{t, k} &= \sigma_a + \sigma_{f, k}\\
  r^l &= \sum_{g=1}^{N_G}\sigma_{f, g}\left(I_g^l - I_g^{l-1} \right)\\
  \xi^l &= \frac{\eta \langle \sigma_f \rangle r^l}{\langle \sigma_t \rangle - \eta \langle \sigma_f \rangle}\\
  \langle \sigma_f \rangle &= \langle \sigma_t \rangle \sum_{g=1}^{N_g} \frac{\chi_g \sigma_{f, g}}{\sigma{t, g}}\\
  \langle \sigma_t \rangle &= {\left[\sum_{g=1}^{N_g} \frac{\chi_g}{\sigma_{t, g}} \right]}^{-1}
  \end{align}
\end{subequations}

Then the specral shape (normalized) of this solution, where $E^l = \sum_{g=1}^{N_g}\epsilon_k^l$, is

\begin{subequations}
  \begin{align}
  \frac{\epsilon_k^l}{E^l} &= \frac{\frac{\eta\chi_k}{\sigma_{t, k}} \left( \xi^l + r^l \right)}{\sum_{g=1}^{N_g}\frac{\eta\chi_g}{\sigma_{t, g}} \left( \xi^l + r^l \right)}\\
  &= \frac{\cancel{\eta\left( \xi^l + r^l \right)}\frac{\chi_k}{\sigma_{t, k}} }{\cancel{\eta\left( \xi^l + r^l \right)}\sum_{g=1}^{N_g}\frac{\chi_g}{\sigma_{t, g}} }\\
  &= \frac{\frac{\chi_k}{\sigma_{t, k}} }{\sum_{g=1}^{N_g}\frac{\chi_g}{\sigma_{t, g}} }\\
  \frac{\epsilon_k^l}{E^l} &= \frac{\langle \sigma_t \rangle \chi_k}{\sigma_{t, k}}.\label{eq:error-spectral-shape}
\end{align}
\end{subequations}


Which is exact as the time step $\Delta t$ approaches infinity (in the equilibrium limit), and is equivalent to the spectral shape used to evaluate Rosseland group opacities. Then, evaluating \autoref{eq:error-diffusion-equation} using the assumed spectral shape,

\begin{align}
  -\nabla \cdot D_k\nabla E^l\frac{ \langle \sigma_t \rangle \chi_k}{\sigma_{t, k}} + \left(\sigma_a + \sigma_{f, k}\right)E^l\frac{ \langle \sigma_t \rangle \chi_k}{\sigma_{t, k}} =\eta \chi_k r^l + \eta \chi_k \sum_{g=1}^{N_g} \sigma_{f, g} E^l\frac{ \langle \sigma_t \rangle \chi_k}{\sigma_{t, k}}.
\end{align}

Expanding the diffusion term using the product rule,


  \begin{multline}
  -\nabla \cdot \left[D_k \frac{ \langle \sigma_t \rangle \chi_k}{\sigma_{t, k}} \nabla E^l     +    D_k E^l \nabla   \frac{ \langle \sigma_t \rangle \chi_k}{\sigma_{t, k}}     \right]  + \left(\sigma_a + \sigma_{f, k}\right)E^l\frac{ \langle \sigma_t \rangle \chi_k}{\sigma_{t, k}} =\\
  \eta \chi_k r^l + \eta \chi_k \sum_{g=1}^{N_g} \sigma_{f, g} E^l\frac{ \langle \sigma_t \rangle \chi_k}{\sigma_{t, k}}.
\end{multline}



Summing over all groups, 

\begin{multline}
  -\nabla \cdot \left[\left( \sum_{k=1}^{N_g}D_k \frac{ \langle \sigma_t \rangle \chi_k}{\sigma_{t, k}}\right) \nabla E^l     +   E^l \left( \sum_{k=1}^{N_g} D_k  \nabla   \frac{ \langle \sigma_t \rangle \chi_k}{\sigma_{t, k}} \right)    \right]  + E^l \sum_{k=1}^{N_g}\left(\sigma_a + \sigma_{f, k}\right)\frac{ \langle \sigma_t \rangle \chi_k}{\sigma_{t, k}} =\\
  \eta  r^l + \sum_{k=1}^{N_g}\eta E^l  \chi_k  \langle \sigma_t \rangle \sum_{g=1}^{N_g} \sigma_{f, g} \frac{  \chi_g}{\sigma_{t, g}}
\end{multline}

\begin{multline}
  -\nabla \cdot \left[\left( \sum_{k=1}^{N_g}D_k \frac{ \langle \sigma_t \rangle \chi_k}{\sigma_{t, k}}\right) \nabla E^l     +   E^l \left( \sum_{k=1}^{N_g} D_k  \nabla   \frac{ \langle \sigma_t \rangle \chi_k}{\sigma_{t, k}} \right)    \right]  + E^l \sum_{k=1}^{N_g}\left(\sigma_a + \sigma_{f, k}\right)\frac{ \langle \sigma_t \rangle \chi_k}{\sigma_{t, k}} =\\
  \eta  r^l + \eta E^l   \langle \sigma_f \rangle,
\end{multline}

which can be written as

\begin{equation}
  -\nabla \cdot \left[\langle D \rangle \nabla E^l     +  \langle D^\prime \rangle  E^l    \right]  + E^l \sum_{k=1}^{N_g}\left(\sigma_a + \sigma_{f, k}\right)\frac{ \langle \sigma_t \rangle \chi_k}{\sigma_{t, k}} =  \eta  r^l + \eta E^l   \langle \sigma_f \rangle,
\end{equation}

where

\begin{subequations}
 \begin{align}
  \langle D \rangle &= \sum_{k=1}^{N_g}D_k \frac{ \langle \sigma_t \rangle \chi_k}{\sigma_{t, k}}  \\
  \langle D^\prime \rangle &= \sum_{k=1}^{N_g} D_k  \nabla   \frac{ \langle \sigma_t \rangle \chi_k}{\sigma_{t, k}}.
\end{align} 
\end{subequations}


Expanding the removal term, 

\begin{subequations}
  \begin{align}
  E^l \sum_{k=1}^{N_g}\left(\sigma_a + \sigma_{f, k}\right)\frac{ \langle \sigma_t \rangle \chi_k}{\sigma_{t, k}} & =  \sigma_a \sum_{k=1}^{N_g}E^l\frac{ \langle \sigma_t \rangle \chi_k}{\sigma_{t, k}} + \sum_{k=1}^{N_g} E^l\frac{ \langle \sigma_t \rangle \chi_k \sigma_{f, k}}{\sigma_{t, k}}\\
  &=  \sigma_a E^l + \langle\sigma_f \rangle E^l,
\end{align}
\end{subequations}


so the one-group error diffusion equation becomes

\begin{align}
  -\nabla \cdot \left[\langle D \rangle \nabla E^l     +  \langle D^\prime \rangle  E^l    \right]  + E^l (\sigma_a + \langle \sigma_f \rangle) &=  \eta  r^l + \eta E^l   \langle \sigma_f \rangle\\
  -\nabla \cdot \left[\langle D \rangle \nabla E^l     +  \langle D^\prime \rangle  E^l    \right]  + E^l \left[\sigma_a + \langle \sigma_f \rangle (1 - \eta)\right] &=  \eta  r^l. 
\end{align}

This provides an equation for the one-group iterative error of a diffusion iteration, which can be used to calculate group errors using \autoref{eq:error-spectral-shape}. Then the set of equations for the accelerated radiative diffusion equation becomes:

\begin{gather}
  \label{eq:diffusion-half-iter}-\nabla \cdot D_k \nabla I_k^{l+1} + \left( \sigma_a + \sigma_{f, k} \right)I_k^{l+1} = \eta \chi_k \sum_{g=1}^{N_g}\sigma_{f, g}I_g^l + S_k\\
  \label{eq:onegroup-error-iter}-\nabla \cdot \left[\langle D \rangle \nabla E^{l+1/2}      +  \langle D^\prime \rangle  E^{l+1/2}    \right]  + E^{l+1/2}  \left[\sigma_a + \langle \sigma_f \rangle (1 - \eta)\right] =  \eta  r^{l+1/2} \\
  \label{eq:fix-diffuion}I^{l+1} = I_k^{l+1} + E^{l+1/2}\frac{\langle \sigma_t \rangle \chi_k}{\sigma_{t, k}}
\end{gather}

where

\begin{equation}
  r^{l+1/2} = \sum_{g=1}^{N_g} \sigma{f, g} \left( I_g^{l+1/2} - I_g^l\right).
\end{equation}

The full algorithm for the time-dependent problem is shown in Algorithm~\ref{alg:packed-dna-hamming}.

\begin{algorithm}
  \caption{Morel, Larsen, Matzen Diffusion Acceleration Scheme~\cite{morel1985synthetic}}\label{alg:packed-dna-hamming}
  \begin{algorithmic}[0]
    % \Require{$x$ and $y$ are packed dna strings of equal length $n$}
    \Statex{}
    \While{$t^j \leq t^{end}$}
      \Let{$j$}{$j+1$}
      \State{Compute temperature-dependent coefficients using $T\vert_{t=t^{j-1}}$}
      \While{$\norm{I^{(s)} - I^{(s-1)}} > \epsilon\norm{I^{(s-1)}}$}
        \Let{$s$}{$s+1$}
        \State{Solve multigroup diffusion equation for $I_k^{(s+1/2)}$, using $I_k^{(s)}$ for the reemission source}
        \State{Compute $r^{(s+1/2)}$}
        \State{Solve one-group error diffusion equation for $E^{(s+1/2)}$}
        \State{Compute $I_k^{(s+1)} = I_k^{(s+1/2)} + E^{(s+1/2)}\langle \sigma_t \rangle \chi_k / \sigma_{t, k}$}
      \EndWhile{}
      \Let{$I_k^{j}$}{$I_k^{(s+1)}$}
      \State{Compute $\Delta T^{j+1/2}$ from $I_k^{j}$}
      \If{$K \neq 0 \land u \neq 0$}
        \State{Solve thermal diffusion equation for $\Delta T^{j+1}$}
      \EndIf{}
      \Let{$T^{j+1}$}{$T^j + \Delta T^{j+1/2} + \Delta T^{j+1}$}
    \EndWhile{}
  \end{algorithmic}
\end{algorithm}

\section{Fourier Analysis}\label{sec:fourier_analysis}

The iterative diffusion equation, \autoref{eq:iterative_neutron}, is


\begin{equation}
  -\nabla \cdot D_k \nabla I_k^{l+1} + \left( \sigma_a + \sigma_{f, k} \right)I_k^{l+1} = \eta \chi_k \sum_{g=1}^{N_g}\sigma_{f, g}I_g^l + S_k.
\end{equation}

Subtracting this from the exact equation, \autoref{eq:neutron_diffusion}, yields the iterative equation for error:

\begin{align}
  -\nabla \cdot D_k \nabla \left(I_k^\star - I_k^{l+1}\right) + \left( \sigma_a + \sigma_{f, k} \right)\left(I_k^\star - I_k^{l+1}\right) &= \eta \chi_k \left(\sum_{g=1}^{N_g}\sigma_{f, g}I_g^\star - \sum_{g=1}^{N_g}\sigma_{f, g}I_g^l\right)\\
  -\nabla \cdot D_k \nabla \epsilon_k^{l+1} + \left( \sigma_a + \sigma_{f, k} \right)\epsilon_k^{l+1} &= \eta \chi_k \sum_{g=1}^{N_g}\sigma_{f, g}\epsilon_g^{l}.\label{eq:iterative-error-convergence} 
\end{align}

For infinite 1D spatial domain and constant coefficients, the Fourier Ansatz assumes a form of the error (and solution),

\begin{equation}
  \epsilon_k^{l}(x) = \epsilon_k^l e^{i\lambda x}.
\end{equation}

Using this assumed form, \autoref{eq:iterative-error-convergence} is

\begin{align}
  -D_k \epsilon_k^{l+1}\nabla^2 e^{i\lambda x} + \left( \sigma_a + \sigma_{f, k} \right)\epsilon_k^{l+1} e^{i\lambda x} &= \eta \chi_k  e^{i\lambda x}\sum_{g=1}^{N_g}\sigma_{f, g}\epsilon_g^{l}\\
  e^{i\lambda x} \left[\lambda^2 D_k \epsilon_k^{l+1} + \left( \sigma_a + \sigma_{f, k} \right)\epsilon_k^{l+1} \right] &= e^{i\lambda x} \left[\eta \chi_k  \sum_{g=1}^{N_g}\sigma_{f, g}\epsilon_g^{l}\right]\\
  \epsilon_k^{l+1} \left[\lambda^2 D_k+ \sigma_a + \sigma_{f, k} \right] &= \eta \chi_k  \sum_{g=1}^{N_g}\sigma_{f, g}\epsilon_g^{l}\\
  \epsilon_k^{l+1}  &=  \frac{\eta \chi_k  \sum_{g=1}^{N_g}\sigma_{f, g}\epsilon_g^{l}}{\lambda^2 D_k+ \sigma_a + \sigma_{f, k}}.
\end{align}

Then, using $F^l = \sum_{k=1}^{N_g}\sigma_{f, k}\epsilon_k^l$, this equation becomes

\begin{align}
  \sum_{k=1}^{N_g}\sigma_{f, k}\epsilon_k^{l+1}  &= \sum_{k=1}^{N_g} \frac{\sigma_{f, k}\eta \chi_k  \sum_{g=1}^{N_g}\sigma_{f, g}\epsilon_g^{l}}{\lambda^2 D_k+ \sigma_a + \sigma_{f, k}}\\
  F^{l+1}  &= \sum_{k=1}^{N_g} \frac{\sigma_{f, k}\eta \chi_k  F^l}{\lambda^2 D_k+ \sigma_a + \sigma_{f, k}}\\
  F^{l+1}  &=  F^l\eta \sum_{k=1}^{N_g} \frac{\sigma_{f, k} \chi_k }{\lambda^2 D_k+ \sigma_a + \sigma_{f, k}},
\end{align}

which corresponds to a Source Iteration eigenvalue of 

\begin{equation}\label{eq:fourier-eigenvalue}
  \omega(\lambda) = \eta \sum_{k=1}^{N_g} \frac{\sigma_{f, k} \chi_k }{\lambda^2 D_k+ \sigma_a + \sigma_{f, k}},
\end{equation}

where 

\begin{equation}
  \sum_{k=1}^{N_g}\sigma_{f, k}\epsilon_k^{l+1} = \omega(\lambda) \sum_{k=1}^{N_g}\sigma_{f, k}\epsilon_k^l.
\end{equation}

The spectral radius corresponds with the eigenmode $\lambda=0$, and is equal to 

\begin{equation}
  \text{spr} = \eta \sum_{k=1}^{N_g} \frac{\sigma_{f, k} \chi_k }{\sigma_a + \sigma_{f, k}}
\end{equation}

As the time step $\Delta t$ becomes large, $\sigma_a \rightarrow 0$ and $\eta \rightarrow 1$, and from \autoref{eq:fourier-eigenvalue}, the spectral radius approaches one. $\eta$ also approaches one for large opacity or small heat capacity, or in strong radiation-material coupling.

t~\cite{fleck1971implicit}

\bibliographystyle{ieeetr}
\bibliography{references.bib}


\end{document}
